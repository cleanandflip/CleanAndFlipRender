Address Autocomplete Fixes Needed
1. Fix Address Format - Remove County & Country
The MapTiler API is returning too much data. Update the parsing logic:
typescript// In useAddressAutocomplete.ts, update the parsing function:
const parsed = data.map(item => {
  // Extract just the city name (not county)
  const city = item.place_name_en?.split(',')[1]?.trim() || 
               item.context?.find(c => c.id.includes('place'))?.text || 
               '';
  
  // Format: "123 Main St, Asheville, NC 28806"
  const formattedAddress = [
    item.address || item.text,
    city,
    item.context?.find(c => c.id.includes('region'))?.short_code?.replace('US-', '') || '',
    item.context?.find(c => c.id.includes('postcode'))?.text || ''
  ].filter(Boolean).join(', ');
  
  return {
    street: item.address || item.text || '',
    city: city,
    state: item.context?.find(c => c.id.includes('region'))?.short_code?.replace('US-', '') || '',
    zipCode: item.context?.find(c => c.id.includes('postcode'))?.text || '',
    fullAddress: formattedAddress, // No "United States"
    coordinates: {
      lat: item.center?.[1] || 0,
      lng: item.center?.[0] || 0
    }
  };
});
2. Fix Dropdown Z-Index & Positioning
Update the dropdown styling in address-autocomplete.tsx:
tsx{showDropdown && suggestions.length > 0 && (
  <div className="absolute z-50 w-full mt-1 bg-gray-900 border border-gray-700 rounded-lg shadow-2xl max-h-60 overflow-auto"
       style={{ 
         zIndex: 9999, // Ensure it's above everything
         position: 'absolute',
         top: '100%' // Position below input
       }}>
    {/* dropdown content */}
  </div>
)}
Also ensure the parent wrapper doesn't have overflow-hidden:
tsx<div ref={wrapperRef} className="relative" style={{ overflow: 'visible' }}>
3. Fix Text Input Alignment
The icon is pushing the text. Update the input padding:
tsx<input
  type="text"
  value={input}
  onChange={handleInputChange}
  placeholder={placeholder}
  required={required}
  className={cn(
    "w-full pl-3 pr-10 py-3 bg-gray-800 border border-gray-700", // Changed pl-10 to pl-3
    "text-white placeholder-gray-500 rounded-lg",
    "focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",
    "transition-all duration-200",
    className
  )}
/>

// Remove or reposition the MapPin icon, or make it absolutely positioned outside the input flow
4. Fix Persistent Address Bug
Add proper state cleanup when clearing:
tsxconst clearInput = () => {
  setInput('');
  setSuggestions([]); // Clear suggestions
  setShowDropdown(false); // Hide dropdown
  onChange({
    street: '',
    city: '',
    state: '',
    zipCode: '',
    fullAddress: ''
  });
};

// Also clear suggestions when input is empty
const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {
  const value = e.target.value;
  setInput(value);
  
  if (value.length === 0) {
    setSuggestions([]);
    setShowDropdown(false);
  } else {
    searchAddress(value);
    setShowDropdown(true);
  }
};
5. Add Local Customer Badge
After address selection, show if they're local:
tsx// Below the input field
{selectedAddress && isLocalCustomer(selectedAddress) && (
  <div className="mt-2 text-sm text-green-500 flex items-center gap-1">
    <CheckCircle className="w-4 h-4" />
    Local customer - Eligible for pickup in Asheville
  </div>
)}
Verification Checklist
Please verify:

Address format now shows: "10 Magnolia Farms Drive, Asheville, NC 28806"
Dropdown appears above other form fields with proper z-index
Text alignment matches other input fields (no icon pushing text)
Clear button properly clears all state and suggestions
Test these pages:

Registration form (/auth)
User profile (/dashboard)
Admin user management
Checkout page
Sell to us page



Additional MapTiler API Adjustments
If the format is still wrong, try these MapTiler parameters:
typescriptconst response = await fetch(
  `https://api.maptiler.com/geocoding/${encodeURIComponent(query)}.json?` +
  `key=${MAPTILER_KEY}&` +
  `country=us&` +
  `types=address&` +
  `autocomplete=true&` +
  `fuzzyMatch=true&` +
  `limit=5`
);
Please implement these fixes and confirm all address functionality is working correctly across the site!