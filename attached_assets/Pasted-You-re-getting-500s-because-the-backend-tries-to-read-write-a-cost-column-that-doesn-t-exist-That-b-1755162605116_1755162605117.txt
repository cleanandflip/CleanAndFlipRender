You’re getting 500s because the backend tries to read/write a cost column that doesn’t exist. That blows up both the update route and the featured-products query, so your modal shows “Could not update product” and the site can’t refresh.

What Replit needs to fix (do all of this)
1) DB migration (adds the missing columns — safe, idempotent)
sql
Copy
Edit
-- products columns your server code already uses
ALTER TABLE products
  ADD COLUMN IF NOT EXISTS cost numeric(10,2),
  ADD COLUMN IF NOT EXISTS compare_at_price numeric(10,2),
  ADD COLUMN IF NOT EXISTS is_local_delivery_available boolean DEFAULT false,
  ADD COLUMN IF NOT EXISTS is_shipping_available       boolean DEFAULT true,
  ADD COLUMN IF NOT EXISTS fulfillment_mode            text DEFAULT 'shipping_only'
    CHECK (fulfillment_mode IN ('local_only','shipping_only','both')),
  ADD COLUMN IF NOT EXISTS is_featured boolean DEFAULT false;
2) Fix the server queries that reference cost
DatabaseStorage.updateProduct (around the line shown in the logs ~466): keep setting cost = $x (now the column exists), but make it optional if the client doesn’t send it:

ts
Copy
Edit
// build SET list only for provided fields
const patch: any = {
  // ...other fields,
  cost: body.cost ?? null,
  compare_at_price: body.compareAtPrice ?? null,
  is_local_delivery_available: body.is_local_delivery_available ?? body.isLocalDeliveryAvailable ?? null,
  is_shipping_available: body.is_shipping_available ?? body.isShippingAvailable ?? null,
  fulfillment_mode: body.fulfillment_mode ?? body.fulfillmentMode ?? null,
  is_featured: body.is_featured ?? body.isFeatured ?? null,
};
DatabaseStorage.getFeaturedProducts (logs point at ~492): your SELECT currently includes cost. Now that the column exists this is fine, but if you want extra safety use:

sql
Copy
Edit
SELECT
  p.id, p.name, p.images, p.price,
  COALESCE(p.compare_at_price, NULL) AS compare_at_price,
  COALESCE(p.cost, NULL) AS cost,
  p.is_featured, p.is_local_delivery_available, p.is_shipping_available, p.fulfillment_mode,
  -- ...rest
FROM products p
WHERE p.is_featured = true AND p.status = 'active'
ORDER BY p.created_at DESC
LIMIT $1;
3) Accept both snake_case and camelCase in the update route
Your modal sends both; the route must persist them:

ts
Copy
Edit
const body = req.body;

// derive mode from booleans if string not provided
const isLocal = body.is_local_delivery_available ?? body.isLocalDeliveryAvailable;
const isShip  = body.is_shipping_available       ?? body.isShippingAvailable;
const mode    = (body.fulfillment_mode ?? body.fulfillmentMode)
             ?? (isLocal && isShip ? 'both' : isLocal ? 'local_only' : 'shipping_only');

await db.updateProduct(id, {
  // …other fields
  cost: body.cost ?? null,
  compare_at_price: body.compareAtPrice ?? null,
  is_local_delivery_available: isLocal,
  is_shipping_available: isShip,
  fulfillment_mode: mode,
  is_featured: body.is_featured ?? body.isFeatured,
});
4) Return these fields on all product GETs
Make sure /api/products, /api/products/featured, and /api/admin/products include:

isLocalDeliveryAvailable / is_local_delivery_available

isShippingAvailable / is_shipping_available

fulfillmentMode / fulfillment_mode

isFeatured / is_featured

cost, compare_at_price

(If you have a serializer, map snake→camel for the client.)

5) Frontend is fine; keep sending both forms
Your modal already sends:

fulfillmentMode + fulfillment_mode

isLocalDeliveryAvailable + is_local_delivery_available

isShippingAvailable + is_shipping_available

isFeatured + is_featured

cost (optional)

Once the DB + server are fixed, the save will succeed and the site will reflect the new fulfillment mode.

Why the error happened
From the logs:

Error getting featured products: column "cost" does not exist (500 on /api/products/featured)

Update product error: column "cost" does not exist (500 on PUT /api/admin/products/:id)

Both originate from server/storage.ts queries that reference cost. Adding the column (and accepting the new fulfillment fields) resolves both the save failure and the stale fulfillment state.