Fix for Replit: Missing Database Tables & Admin Access Issue
Your database is missing critical tables. Here's how to fix:

IMMEDIATE FIX: Create Missing Database Tables
bash# 1. Stop the server (Ctrl+C)

# 2. Generate fresh migrations for ALL tables
npm run db:generate

# 3. Run migrations to create the missing tables
npm run db:migrate

# 4. If migrations fail, force push the schema:
npx drizzle-kit push:pg

# 5. Verify tables were created - run this SQL in your Neon console:
SELECT table_name FROM information_schema.tables 
WHERE table_schema = 'public';
FIX ADMIN BUTTON VISIBILITY
Edit /client/src/components/Navigation.tsx:
Find this section and ensure admin button only shows for admin users:
tsx// FIND THIS:
{user && (
  <Link to="/admin">
    <Button>Admin Dashboard</Button>
  </Link>
)}

// REPLACE WITH:
{user && user.role === 'admin' && (
  <Link to="/admin">
    <Button variant="outline" size="sm">
      Admin Dashboard
    </Button>
  </Link>
)}
UPDATE USER ROLE CHECK
Edit /server/storage.ts - ensure users table has proper role field:
typescript// In the users table schema, verify this exists:
role: text('role').default('user').notNull(),
SEED ADMIN USER
Create file /server/seed-admin.ts:
typescriptimport { db } from './db';
import { users } from '@db/schema';
import bcrypt from 'bcryptjs';

async function seedAdmin() {
  const hashedPassword = await bcrypt.hash('admin123', 12);
  
  await db.insert(users).values({
    email: 'admin@cleanflip.com',
    username: 'admin',
    password: hashedPassword,
    role: 'admin'
  }).onConflictDoNothing();
  
  console.log('Admin user created/verified');
}

seedAdmin();
Run: tsx server/seed-admin.ts
IF TABLES STILL DON'T EXIST
Run this SQL directly in Neon Dashboard:
sql-- Create missing tables manually
CREATE TABLE IF NOT EXISTS wishlist (
  id SERIAL PRIMARY KEY,
  user_id TEXT NOT NULL,
  product_id INTEGER NOT NULL,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE TABLE IF NOT EXISTS cart_items (
  id SERIAL PRIMARY KEY,
  user_id TEXT NOT NULL,
  product_id INTEGER NOT NULL,
  quantity INTEGER DEFAULT 1,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE TABLE IF NOT EXISTS orders (
  id SERIAL PRIMARY KEY,
  user_id TEXT NOT NULL,
  total DECIMAL(10,2),
  status TEXT DEFAULT 'pending',
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE TABLE IF NOT EXISTS order_items (
  id SERIAL PRIMARY KEY,
  order_id INTEGER REFERENCES orders(id),
  product_id INTEGER,
  quantity INTEGER,
  price DECIMAL(10,2)
);

CREATE TABLE IF NOT EXISTS equipment_submissions (
  id SERIAL PRIMARY KEY,
  user_id TEXT,
  reference_code TEXT UNIQUE,
  name TEXT,
  email TEXT,
  phone TEXT,
  brand TEXT,
  model TEXT,
  condition TEXT,
  description TEXT,
  images TEXT[],
  status TEXT DEFAULT 'pending',
  created_at TIMESTAMP DEFAULT NOW()
);
UPDATE YOUR USER'S ROLE
Since you just registered, update your user to admin in Neon SQL console:
sqlUPDATE users 
SET role = 'admin' 
WHERE email = 'YOUR_EMAIL_HERE';
RESTART SERVER
bashnpm run dev
Expected Result:

All database tables created
No more "relation does not exist" errors
Admin button only visible to admin users
Orders, cart, and wishlist working properly