Fix for Replit: Column Name Mismatches
The database schema doesn't match what the code expects. Fix these column mismatches:

QUICK FIX: Update Column Names in Database
Run this SQL in your Neon console to add the missing columns:
sql-- Fix orders table - add subtotal column
ALTER TABLE orders 
ADD COLUMN IF NOT EXISTS subtotal DECIMAL(10,2);

-- Copy existing total values to subtotal
UPDATE orders SET subtotal = total WHERE subtotal IS NULL;

-- Fix equipment_submissions table - add reference_number column
ALTER TABLE equipment_submissions 
ADD COLUMN IF NOT EXISTS reference_number TEXT;

-- Copy existing reference_code values to reference_number
UPDATE equipment_submissions 
SET reference_number = reference_code 
WHERE reference_number IS NULL;
OR BETTER FIX: Update the Code to Match Database
Fix 1: Update /server/storage.ts - Find getUserOrders function (around line 851):
typescript// FIND THIS LINE:
const query = sql`
  SELECT 
    id,
    subtotal,  // WRONG COLUMN NAME
    ...

// CHANGE TO:
const query = sql`
  SELECT 
    id,
    total as subtotal,  // ALIAS IT
    ...
Fix 2: Update /server/routes.ts - Find equipment submissions query (around line 2320):
typescript// FIND:
SELECT 
  id,
  reference_number,  // WRONG COLUMN NAME
  ...

// CHANGE TO:
SELECT 
  id,
  reference_code as reference_number,  // ALIAS IT
  ...
PERMANENT FIX: Sync Schema Properly
Edit /db/schema.ts to ensure consistency:
typescript// orders table should have:
export const orders = pgTable('orders', {
  id: serial('id').primaryKey(),
  user_id: text('user_id').notNull(),
  subtotal: decimal('subtotal', { precision: 10, scale: 2 }),
  total: decimal('total', { precision: 10, scale: 2 }),
  // ... rest of columns
});

// equipment_submissions should have:
export const equipment_submissions = pgTable('equipment_submissions', {
  id: serial('id').primaryKey(),
  reference_code: text('reference_code'),
  reference_number: text('reference_number'), // Add this alias
  // ... rest of columns
});
Then regenerate:
bashnpm run db:generate
npm run db:migrate
FASTEST FIX (Do This First):
Just run this SQL in Neon console - it adds the missing columns without breaking existing data:
sql-- Add missing columns with data from existing columns
ALTER TABLE orders ADD COLUMN IF NOT EXISTS subtotal DECIMAL(10,2);
UPDATE orders SET subtotal = COALESCE(total, 0);

ALTER TABLE equipment_submissions ADD COLUMN IF NOT EXISTS reference_number TEXT;
UPDATE equipment_submissions SET reference_number = COALESCE(reference_code, '');
Restart server after fixing:
bashnpm run dev
Result: Orders page will load without errors!